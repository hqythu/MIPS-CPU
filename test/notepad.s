START:
	LI R3 0x0 ;行号
	LI R4 0x0 ;列号

INIT:
	LI		R0 0XF8
	SLL		R0 R0 0X0
	LI		R2 0X04
	SLL		R2 R2 0X0
	ADDIU 	R2 0X50
	ADDIU 	R2 0X60
	LI		R3 0X0
INIT_F800:
	SW 		R0 R3 0X0
	ADDIU 	R0 0X1
	ADDIU 	R2 0XFF
	CMP		R2 R3
	BTNEZ 	INIT_F800
	NOP

	MFPC R7
	ADDIU R7 0x2
	B PRINT_CURSOR
	NOP
WAIT:	;判断键盘是否可读
	NOP
	LI R0 0xBF
	SLL R0 R0 0x0
	LW R0 R1 0x03
	NOP
	BEQZ R1 WAIT
	NOP
LOAD:	;读取键盘
	LW R0 R2 0x02

	MFPC R7
	ADDIU R7 0X2
	B CLEAR_CURSOR
	NOP

	LI R0 0x12
	CMP R0 R2
	BTEQZ ENTER
	NOP

	LI R0 0X21
	CMP R0 R2
	BTEQZ UP
	NOP

	LI R0 0X22
	CMP R0 R2
	BTEQZ LEFT
	NOP

	LI R0 0X23
	CMP R0 R2
	BTEQZ DOWN
	NOP

	LI R0 0X24
	CMP R0 R2
	BTEQZ RIGHT
	NOP

	B JUDGECOLUMN
	NOP
ENTER:
	ADDIU R3 0x1
	LI R4 0x0
	B MOVE_CURSOR
	NOP
UP:
	ADDIU R3 0xFF
	B MOVE_CURSOR
	NOP
DOWN:
	ADDIU R3 0x1
	B MOVE_CURSOR
	NOP
LEFT:
	ADDIU R4 0xFF
	B MOVE_CURSOR
	NOP
RIGHT:
	ADDIU R4 0x1
	B MOVE_CURSOR
	NOP
MOVE_CURSOR:
	MFPC R7
	ADDIU R7 0X2
	B PRINT_CURSOR
	NOP
	B WAIT
	NOP
JUDGECOLUMN:	;判断是否达到行尾
	LI R0 0x28	;每行40字
	CMP R0 R4
	BTNEZ JUDGEROW
	NOP
	ADDIU R3 0x1	;行号+1
	LI R4 0x0		;列号归0
JUDGEROW:		;判断是否到达屏幕尾端
	LI R0 0x1E	;30行
	CMP R0 R3
	BTNEZ PRINT
	NOP
	LI R3 0x0	;行号清零
PRINT:
	LI R0 0xF8
	SLL R0 R0 0x0	;显存起始地址
	SLL R1 R3 0x5	;行号 * 32
	SLL R5 R3 0X3	;行号 * 8
	ADDU R1 R5 R1
	ADDU R0 R1 R0
	ADDU R0 R4 R0	;偏移量 = 行号 * 40 + 列号
	ADDIU R4 0x1	;列号+1
	SW R0 R2 0x0
	MFPC R7
	ADDIU R7 0X2
	B PRINT_CURSOR
	NOP
	B WAIT
	NOP
PRINT_CURSOR:
	LI R0 0xF8
	SLL R0 R0 0x0	;显存起始地址
	SLL R1 R3 0x5	;行号 * 32
	SLL R5 R3 0X3	;行号 * 8
	ADDU R1 R5 R1
	ADDU R0 R1 R0
	ADDU R0 R4 R0	;偏移量 = 行号 * 40 + 列号
	LW R0 R5 0X0
	LI R1 0X0
	SUBU R1 R5 R5
	ADDIU R5 0XFF
	SW R0 R5 0X0
	JR R7
	NOP
CLEAR_CURSOR:
	LI R0 0xF8
	SLL R0 R0 0x0	;显存起始地址
	SLL R1 R3 0x5	;行号 * 32
	SLL R5 R3 0X3	;行号 * 8
	ADDU R1 R5 R1
	ADDU R0 R1 R0
	ADDU R0 R4 R0	;偏移量 = 行号 * 40 + 列号
	LW R0 R5 0X0
	LI R1 0X0
	SUBU R1 R5 R5
	ADDIU R5 0XFF
	SW R0 R5 0X0
	JR R7
	NOP

	B WAIT		;返回起始
	NOP
	JR R7
	NOP
